<!doctype html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>MODEL WORLD - Qu·∫£n l√Ω danh m·ª•c</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@300;400;500;600;700;800&family=Orbitron:wght@500;700&display=swap" rel="stylesheet">


<style>
/* --- C·∫§U H√åNH M√ÄU S·∫ÆC & BI·∫æN (ƒê·ªíNG B·ªò) --- */
:root {
    --bg-dark: #050b14;
    --bg-card: #0c1525;
    --text-light: #e1e7ff;
    --accent-cyan: #00f2ff; /* M√†u Neon Cyan ch√≠nh */
    --border-color: rgba(0, 242, 255, 0.2);
    
    /* Font Variables */
    --font-main: "Be Vietnam Pro", sans-serif;
    --font-display: "Orbitron", sans-serif;

    /* ƒê·ªäNH NGHƒ®A HI·ªÜU ·ª®NG NEON GLOW */
    --neon-box-shadow: 0 0 10px rgba(0, 242, 255, 0.3);
}

body {
    /* Background neon city */
    background: 
        linear-gradient(135deg, var(--bg-dark), #1a0033),
        url('https://file.hstatic.net/200000838897/article/anime_figure_008aea7949c540cd8500f596197eb317.jpg') center/cover no-repeat fixed;
    color: var(--text-light);
    min-height: 100vh;
    overflow-x: hidden;
    position: relative;
    font-family: var(--font-main);
}

/* TYPOGRAPHY FIX */
h2, h4, h5, h6 { font-family: var(--font-main); font-weight: 700; }
.navbar-brand { font-family: var(--font-display); text-transform: uppercase; letter-spacing: 1px; }
.navbar-brand span { color: #fff; }


/* üåü NAVBAR (ƒê√É ƒê·ªíNG B·ªò V·ªöI DASHBOARD) */
.navbar {
    background: linear-gradient(90deg, var(--bg-dark), var(--bg-card));
    border-bottom: 1px solid var(--border-color);
    box-shadow: 0 0 15px rgba(0, 242, 255, 0.5); /* Neon glow */
}
.navbar .nav-link { 
    color: var(--accent-cyan) !important; 
    transition: 0.3s;
    font-weight: 500;
}
.navbar .nav-link:hover {
    color: var(--text-light) !important;
    text-shadow: 0 0 8px var(--accent-cyan);
}


/* CARD & BOX STYLE */
.card {
    background-color: var(--bg-card);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    backdrop-filter: blur(8px);
    box-shadow: 0 0 10px rgba(0,0,0,0.5);
    transition: 0.3s ease;
}
.card:hover {
    box-shadow: var(--neon-box-shadow);
}

.card h5, h2, label, th, .text-neon {
  color: var(--accent-cyan) !important;
}

/* TABLE */
.table {
    border-radius: 12px;
    overflow: hidden;
    border: 1px solid var(--border-color);
}
.table thead { background-color: var(--bg-card); }
.table th { 
    color: var(--accent-cyan); 
    font-weight: 600; 
    border-bottom: 1px solid var(--border-color);
}
.table-dark tbody tr { 
    background-color: transparent !important;
    border-color: rgba(255,255,255,0.05);
}
.table td { color: var(--text-light); vertical-align: middle; }
.table-hover tbody tr:hover { 
    background-color: rgba(0,242,255,0.1) !important; 
}


/* BUTTONS (S·ª≠ d·ª•ng style Neon Cyan) */
.btn-neon-action {
  background: transparent;
  border: 1px solid var(--accent-cyan);
  color: var(--accent-cyan);
  font-weight: 600;
  border-radius: 8px;
  transition: 0.3s;
}
.btn-neon-action:hover {
  background: var(--accent-cyan);
  color: var(--bg-dark);
  box-shadow: 0 0 15px var(--accent-cyan);
  transform: scale(1.02);
}

/* FORM CONTROL */
.form-control, .form-select {
    background-color: rgba(0, 0, 0, 0.3) !important;
    color: var(--text-light) !important;
    border: 1px solid var(--border-color);
    transition: 0.3s;
}
.form-control:focus, .form-select:focus {
    border-color: var(--accent-cyan);
    box-shadow: 0 0 5px rgba(0, 242, 255, 0.5);
}

/* IMAGE PREVIEW */
img.category-img {
  border-radius: 8px;
  border: 1px solid var(--accent-cyan);
  transition: 0.3s;
  object-fit: cover;
}
img.category-img:hover {
  transform: scale(1.05);
  box-shadow: 0 0 8px var(--accent-cyan);
}

/* FOOTER */
footer {
    background: linear-gradient(90deg, var(--bg-dark), var(--bg-card));
    border-top: 1px solid var(--border-color);
    color: rgba(255,255,255,0.85);
    padding: 20px 0;
}

/* ALERT */
.alert-custom {
  border: 1px solid var(--accent-cyan);
  background-color: rgba(0, 242, 255, 0.1);
  color: var(--accent-cyan);
}
.alert-custom .btn-close-white {
    filter: invert(1);
}


/* Rain effect */
.rain {
  pointer-events: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 9999;
}
.drop {
  position: absolute;
  width: 2px;
  height: 15px;
  background: linear-gradient(to bottom, var(--accent-cyan), rgba(0,255,255,0));
  animation: fall linear infinite;
  opacity: 0.7;
}
@keyframes fall {
  0% { transform: translateY(-20px); }
  100% { transform: translateY(100vh); }
}
</style>
</head>

<body>

<nav class="navbar navbar-expand-lg px-4 py-3 sticky-top">
  <div class="container-fluid">
    <a class="navbar-brand d-flex align-items-center gap-2" th:href="@{/stats}"> 
        <i class="bi bi-box-seam-fill fs-3" style="color: var(--accent-cyan);"></i>
        <span class="fw-bold fs-4">MODEL WORLD</span>
    </a>
    <div class="collapse navbar-collapse justify-content-end">
      <ul class="navbar-nav me-3">
        <li class="nav-item"><a class="nav-link" th:href="@{/cata-mana}"><i class="bi bi-tags me-1"></i> Danh m·ª•c</a></li>
        <li class="nav-item"><a class="nav-link" th:href="@{/product-mana}"><i class="bi bi-box-seam me-1"></i> S·∫£n ph·∫©m</a></li>
        <li class="nav-item"><a class="nav-link" th:href="@{/orders-mana}"><i class="bi bi-receipt me-1"></i> ƒê∆°n h√†ng</a></li>
        <li class="nav-item"><a class="nav-link" th:href="@{/user-mana}"><i class="bi bi-people me-1"></i> Ng∆∞·ªùi d√πng</a></li>
        <li class="nav-item"><a class="nav-link" th:href="@{/admin/cart}"><i class="bi bi-cart3 me-1"></i> Gi·ªè h√†ng</a></li>
      </ul>
    </div>
  </div>
</nav>

<div class="container py-5">

  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="mb-0 text-neon">
      <i class="bi bi-tags"></i> Qu·∫£n l√Ω danh m·ª•c
    </h2>
    <a th:href="@{/stats}" class="btn btn-neon-action">
      <i class="bi bi-arrow-left-circle me-1"></i> V·ªÅ menu Admin
    </a>
  </div>

  <div th:if="${param.success}" class="alert alert-custom alert-dismissible fade show text-center mb-4">
    <i class="bi bi-check-circle-fill me-2"></i> C·∫≠p nh·∫≠t th√†nh c√¥ng!
    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="alert"></button>
  </div>

  <div th:if="${param.error}" class="alert alert-danger alert-dismissible fade show text-center mb-4">
    <i class="bi bi-exclamation-triangle-fill me-2"></i>
    <span th:switch="${param.error}">
      <span th:case="'emptyName'">T√™n danh m·ª•c kh√¥ng ƒë∆∞·ª£c ƒë·ªÉ tr·ªëng!</span>
      <span th:case="'notfound'">Kh√¥ng t√¨m th·∫•y danh m·ª•c ƒë·ªÉ c·∫≠p nh·∫≠t!</span>
      <span th:case="*">ƒê√£ x·∫£y ra l·ªói, vui l√≤ng th·ª≠ l·∫°i!</span>
    </span>
    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
  </div>

  <div class="card shadow mb-5">
    <div class="card-body p-0">
      <table class="table table-dark table-hover mb-0 text-center align-middle">
        <thead>
          <tr>
            <th>ID</th>
            <th>T√™n danh m·ª•c</th>
            <th>H√¨nh ·∫£nh</th>
            <th>H√†nh ƒë·ªông</th>
          </tr>
        </thead>
        <tbody>
          <tr th:each="c : ${categories}">
            <td th:text="${c.id}">1</td>
            <td th:text="${c.name}">Figure</td>
            <td>
              <img th:src="@{${c.image}}" width="80" height="80" class="category-img" alt="H√¨nh danh m·ª•c">
            </td>
            <td>
              <button class="btn btn-sm btn-neon-action"
                th:attr="data-bs-id=${c.id},data-bs-name=${c.name},data-bs-image=@{${c.image}}"
                data-bs-toggle="modal" data-bs-target="#editCategoryModal">
                <i class="bi bi-pencil-square"></i> S·ª≠a
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="card p-4 shadow-lg">
    <h5 class="mb-3 text-neon">
      <i class="bi bi-plus-circle"></i> Th√™m danh m·ª•c m·ªõi
    </h5>
    <form th:action="@{/cata-mana/add}" method="post" enctype="multipart/form-data">
      <div class="mb-3">
        <label class="form-label text-neon">T√™n danh m·ª•c</label>
        <input type="text" name="name"
          class="form-control"
          placeholder="Nh·∫≠p t√™n danh m·ª•c" required>
      </div>
      <div class="mb-3">
        <label class="form-label text-neon">H√¨nh ·∫£nh (ch·ªçn t·ªáp)</label>
        <input type="file" name="image"
          class="form-control"
          accept="image/*" required>
      </div>
      <button type="submit" class="btn btn-neon-action w-100 py-2">
        <i class="bi bi-save2"></i> Th√™m danh m·ª•c
      </button>
    </form>
  </div>
</div>

<div class="modal fade" id="editCategoryModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content" style="background-color: var(--bg-card); border: 1px solid var(--border-color);">
      <div class="modal-header" style="border-bottom: 1px solid var(--border-color);">
        <h5 class="modal-title text-neon">
          <i class="bi bi-pencil-square"></i> S·ª≠a danh m·ª•c
        </h5>
        <button type="button" class="btn-close" style="filter: invert(1) brightness(200%);" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form th:action="@{/cata-mana/update}" method="post"
          enctype="multipart/form-data" id="editCategoryForm">
          <input type="hidden" name="id" id="editId">
          <div class="mb-3">
            <label class="form-label text-neon">T√™n danh m·ª•c</label>
            <input type="text" name="name" id="editName"
              class="form-control" required>
          </div>
          <div class="mb-3">
            <label class="form-label text-neon">H√¨nh ·∫£nh m·ªõi (t√πy ch·ªçn)</label>
            <input type="file" name="imageFile"
              class="form-control"
              accept="image/*">
          </div>
          <div class="text-center mb-3">
            <img id="previewImage" src="" width="100" height="100" class="category-img" alt="·∫¢nh hi·ªán t·∫°i">
          </div>
          <button type="submit" class="btn btn-neon-action w-100 py-2">
            <i class="bi bi-save2"></i> L∆∞u thay ƒë·ªïi
          </button>
        </form>
      </div>
    </div>
  </div>
</div>

<footer class="text-center py-4">
  <small>¬© 2025 <span style="color: var(--accent-cyan);">MODEL WORLD</span> | Category Management</small>
</footer>

<div class="rain" id="rain"></div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
// Rain effect
const rain = document.getElementById('rain');
// GI·∫¢M S·ªê L∆Ø·ª¢NG GI·ªåT M∆ØA V√Ä TƒÇNG DELAY ƒê·ªÇ GI·∫¢M T·∫¶N SU·∫§T
const drops = 50; // Gi·∫£m t·ª´ 100 xu·ªëng 50
for(let i=0;i<drops;i++){
  const drop = document.createElement('div');
  drop.className = 'drop';
  drop.style.left = Math.random() * 100 + 'vw';
  drop.style.animationDuration = 0.5 + Math.random()*0.5 + 's';
  drop.style.animationDelay = Math.random()*10 + 's'; // TƒÉng th·ªùi gian delay t·ªëi ƒëa (t·ª´ 5s l√™n 10s)
  rain.appendChild(drop);
}

// Modal edit category
var editModal = document.getElementById('editCategoryModal');
editModal.addEventListener('show.bs.modal', function(event) {
  var button = event.relatedTarget;
  document.getElementById('editId').value = button.getAttribute('data-bs-id');
  document.getElementById('editName').value = button.getAttribute('data-bs-name');
  document.getElementById('previewImage').src = button.getAttribute('data-bs-image');
});
</script>

</body>
</html>