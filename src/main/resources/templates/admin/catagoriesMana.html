<!doctype html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>MODEL WORLD - Quản lý danh mục</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@300;400;500;600;700;800&family=Orbitron:wght@500;700&display=swap" rel="stylesheet">

<style>
:root {
  --bg-dark:#050b14;
  --bg-card:#0c1525;
  --text-light:#e1e7ff;
  --accent-cyan:#00f2ff;
  --border-color:rgba(0,242,255,.2);
  --neon-shadow:0 0 10px rgba(0,242,255,.35);
  --font-main:"Be Vietnam Pro",sans-serif;
  --font-display:"Orbitron",sans-serif;
}

body{
  background:
    linear-gradient(135deg,var(--bg-dark),#1a0033),
    url('https://file.hstatic.net/200000838897/article/anime_figure_008aea7949c540cd8500f596197eb317.jpg')
    center/cover no-repeat fixed;
  color:var(--text-light);
  font-family:var(--font-main);
  min-height:100vh;
}

.navbar{
  background:linear-gradient(90deg,var(--bg-dark),var(--bg-card));
  border-bottom:1px solid var(--border-color);
  box-shadow:0 0 15px rgba(0,242,255,.4);
}
.navbar-brand{
  font-family:var(--font-display);
  letter-spacing:1px;
}
.nav-link{
  color:var(--accent-cyan)!important;
}
.nav-link:hover{
  color:#fff!important;
  text-shadow:0 0 8px var(--accent-cyan);
}

.card{
  background:var(--bg-card);
  border:1px solid var(--border-color);
  border-radius:14px;
  transition:.3s;
}
.card:hover{
  transform:translateY(-4px);
  box-shadow:var(--neon-shadow);
}

.table{
  border-radius:14px;
  overflow:hidden;
  border:1px solid var(--border-color);
}
.table th{
  color:var(--accent-cyan);
  border-bottom:1px solid var(--border-color);
}
.table-dark tbody tr{
  background:transparent!important;
}
.table-hover tbody tr:hover{
  background:rgba(0,242,255,.1)!important;
}

.category-img{
  width:80px;
  height:80px;
  object-fit:cover;
  border-radius:10px;
  border:1px solid var(--accent-cyan);
}

.btn-neon{
  border:1px solid var(--accent-cyan);
  color:var(--accent-cyan);
  background:transparent;
  transition:.3s;
}
.btn-neon:hover{
  background:var(--accent-cyan);
  color:#000;
  box-shadow:var(--neon-shadow);
}

.footer{
  background:linear-gradient(90deg,var(--bg-dark),var(--bg-card));
  border-top:1px solid var(--border-color);
}
</style>
</head>

<body>

<nav class="navbar navbar-expand-lg px-4 py-3 sticky-top">
  <div class="container-fluid">
    <a class="navbar-brand d-flex align-items-center gap-2" href="/stats"> 
        <i class="bi bi-box-seam-fill fs-3" style="color: var(--accent-cyan);"></i>
        <span class="fw-bold fs-4 text-light">MODEL WORLD</span>
    </a>
    <div class="collapse navbar-collapse justify-content-end">
      <ul class="navbar-nav me-3">
        <li class="nav-item"><a class="nav-link" href="/cata-mana"><i class="bi bi-tags me-1"></i> Danh mục</a></li>
        <li class="nav-item"><a class="nav-link" href="/product-mana"><i class="bi bi-box-seam me-1"></i> Sản phẩm</a></li>
        <li class="nav-item"><a class="nav-link" href="/orders-mana"><i class="bi bi-receipt me-1"></i> Đơn hàng</a></li>
        <li class="nav-item"><a class="nav-link" href="/user-mana"><i class="bi bi-people me-1"></i> Người dùng</a></li>
        <li class="nav-item"><a class="nav-link" href="/admin/cart"><i class="bi bi-cart3 me-1"></i> Giỏ hàng</a></li>
      </ul>
    </div>
  </div>
</nav>


<div class="container py-5">

<h2 class="text-center mb-5" style="color:var(--accent-cyan)">
<i class="bi bi-tags-fill me-2"></i>QUẢN LÝ DANH MỤC
</h2>

<!-- TABLE -->
<div class="card mb-5">
<div class="card-body p-0">
<table class="table table-dark table-hover text-center align-middle mb-0">
<thead>
<tr>
<th>ID</th>
<th>Tên danh mục</th>
<th>Hình ảnh</th>
<th>Hành động</th>
</tr>
</thead>
<tbody>

<tr th:each="c : ${categories}">
<td th:text="${c.id}"></td>
<td th:text="${c.name}"></td>
<td>
  <img th:if="${c.image}" th:src="@{${c.image}}" class="category-img">
  <span th:if="${c.image == null}" class="fst-italic text-muted">Chưa có ảnh</span>
</td>
<td>
<button class="btn btn-sm btn-neon"
        th:attr="data-bs-id=${c.id},data-bs-name=${c.name},data-bs-image=${c.image}"
        data-bs-toggle="modal"
        data-bs-target="#editCategoryModal">
<i class="bi bi-pencil-square"></i> Sửa
</button>
</td>
</tr>

</tbody>
</table>
</div>
</div>

<!-- ADD -->
<div class="card p-4 mb-5">
<h5 class="mb-3" style="color:var(--accent-cyan)">
<i class="bi bi-plus-circle me-2"></i>Thêm danh mục
</h5>
<form th:action="@{/cata-mana/add}" method="post" enctype="multipart/form-data">
<input class="form-control mb-3" name="name" placeholder="Tên danh mục" required>
<input class="form-control mb-3" type="file" name="image" accept="image/*" required>
<button class="btn btn-neon w-100">Thêm danh mục</button>
</form>
</div>

</div>

<!-- MODAL EDIT -->
<div class="modal fade" id="editCategoryModal" tabindex="-1">
<div class="modal-dialog modal-dialog-centered">
<div class="modal-content bg-dark border border-info">
<div class="modal-header">
<h5 class="modal-title" style="color:var(--accent-cyan)">Sửa danh mục</h5>
<button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
</div>
<div class="modal-body">
<form th:action="@{/cata-mana/update}" method="post" enctype="multipart/form-data">
<input type="hidden" name="id" id="editId">
<input class="form-control mb-3" id="editName" name="name" required>
<input class="form-control mb-3" type="file" name="imageFile" accept="image/*">

<div class="text-center mb-3">
<img id="previewImage" class="category-img">
</div>

<button class="btn btn-neon w-100">Lưu thay đổi</button>
</form>
</div>
</div>
</div>
</div>

<footer class="footer text-center py-4 mt-5">
<small>© 2025 <span style="color:var(--accent-cyan)">MODEL WORLD</span></small>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
var modal = document.getElementById('editCategoryModal');
modal.addEventListener('show.bs.modal', function (e) {
  const btn = e.relatedTarget;
  document.getElementById('editId').value = btn.dataset.bsId;
  document.getElementById('editName').value = btn.dataset.bsName;

  const preview = document.getElementById('previewImage');
  if(btn.dataset.bsImage){
    preview.src = btn.dataset.bsImage;
    preview.style.display = 'inline-block';
  }else{
    preview.style.display = 'none';
  }
});
</script>

</body>
</html>
