<!doctype html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>MODEL WORLD - Qu·∫£n l√Ω s·∫£n ph·∫©m</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@300;400;600;700&family=Orbitron:wght@500;700&display=swap" rel="stylesheet">

<style>
:root {
    --bg-dark:#050b14; --bg-card:#0c1525; --text-light:#e1e7ff;
    --accent-cyan:#00f2ff; --border-color:rgba(0,242,255,.2);
}
body{background:linear-gradient(135deg,var(--bg-dark),#1a0033);color:var(--text-light);font-family:"Be Vietnam Pro";}
.navbar{background:linear-gradient(90deg,var(--bg-dark),var(--bg-card));border-bottom:1px solid var(--border-color);}
.navbar .nav-link{color:var(--accent-cyan)!important;}
.card{background:var(--bg-card);border:1px solid var(--border-color);border-radius:12px;}
.card-header{background:var(--bg-dark);color:var(--accent-cyan);}
.form-control,.form-select{background:rgba(0,0,0,.3);color:white;border:1px solid var(--border-color);}
.btn-neon{border:1px solid var(--accent-cyan);color:var(--accent-cyan);background:transparent;}
.btn-neon:hover{background:var(--accent-cyan);color:black;}
</style>
</head>

<body>

<nav class="navbar navbar-expand-lg px-4 py-3 sticky-top">
<div class="container-fluid">
<a class="navbar-brand fw-bold text-light" th:href="@{/stats}">MODEL WORLD ADMIN</a>
<ul class="navbar-nav ms-auto">
<li class="nav-item"><a class="nav-link" th:href="@{/cata-mana}">Danh m·ª•c</a></li>
<li class="nav-item"><a class="nav-link" th:href="@{/product-mana}">S·∫£n ph·∫©m</a></li>
<li class="nav-item"><a class="nav-link" th:href="@{/orders-mana}">ƒê∆°n h√†ng</a></li>
<li class="nav-item"><a class="nav-link" th:href="@{/user-mana}">Ng∆∞·ªùi d√πng</a></li>
</ul>
</div>
</nav>

<div class="container py-5">

<h2>üì¶ Qu·∫£n l√Ω s·∫£n ph·∫©m</h2>

<!-- ================= LIST ================= -->
<div class="card mb-4">
<div class="card-body p-0">
<table class="table table-dark table-hover text-center align-middle mb-0">
<thead>
<tr>
<th>ID</th><th>·∫¢nh</th><th>T√™n</th><th>Danh m·ª•c</th><th>Gi√°</th><th>Tr·∫°ng th√°i</th><th>Action</th>
</tr>
</thead>
<tbody>

<tr th:each="p : ${list}">
<td th:text="${p.id}"></td>

<!-- ‚úÖ FIX ·∫¢NH -->
<td>
    <img th:src="@{${p.image != null ? p.image : '/images/no-image.png'}}"
         width="60" height="60" class="rounded border">
</td>

<td th:text="${p.name}"></td>
<td th:text="${p.category != null ? p.category.name : '---'}"></td>
<td th:text="${#numbers.formatInteger(p.price,0,'POINT')} + ' ‚Ç´'"></td>
<td>
    <span th:text="${p.available ? 'C√≤n' : 'H·∫øt'}"
          th:class="${p.available ? 'badge bg-success' : 'badge bg-danger'}"></span>
</td>

<td>
<a th:href="@{/product-mana/edit/{id}(id=${p.id})}" class="btn btn-sm btn-neon">S·ª≠a</a>
<a th:href="@{/product-mana/delete/{id}(id=${p.id})}" class="btn btn-sm btn-danger"
   onclick="return confirm('X√≥a s·∫£n ph·∫©m n√†y?')">X√≥a</a>
</td>
</tr>

</tbody>
</table>
</div>
</div>

<!-- ================= ADD ================= -->
<form th:if="${product.id==null}" th:action="@{/product-mana/add}" th:object="${product}"
method="post" enctype="multipart/form-data">

<div class="card">
<div class="card-header">‚ûï Th√™m s·∫£n ph·∫©m</div>
<div class="card-body">

<input type="hidden" th:field="*{id}">

<div class="row g-3">
<div class="col-md-4">
<label>T√™n</label>
<input th:field="*{name}" class="form-control">
</div>

<div class="col-md-2">
<label>Gi√°</label>
<input type="number" th:field="*{price}" class="form-control">
</div>

<div class="col-md-6">
<label>·∫¢nh s·∫£n ph·∫©m</label>
<input type="file" name="imageFiles" multiple class="form-control">
</div>

<div class="col-md-3">
<label>·∫¢nh ƒë·∫°i di·ªán (index)</label>
<input type="number" name="thumbnailIndex" value="0" class="form-control">
</div>

<div class="col-md-3">
<label>Danh m·ª•c</label>
<select th:field="*{category.id}" class="form-select">
<option value="">-- Ch·ªçn --</option>
<option th:each="c:${categories}" th:value="${c.id}" th:text="${c.name}"></option>
</select>
</div>

<div class="col-md-2">
<label>Tr·∫°ng th√°i</label>
<select th:field="*{available}" class="form-select">
<option th:value="true">C√≤n</option>
<option th:value="false">H·∫øt</option>
</select>
</div>
</div>

<button class="btn btn-neon mt-3">Th√™m</button>

</div>
</div>
</form>

<!-- ================= UPDATE ================= -->
<form th:if="${product.id!=null}" th:action="@{/product-mana/update}" th:object="${product}"
method="post" enctype="multipart/form-data">

<div class="card mt-4">
<div class="card-header">‚úè C·∫≠p nh·∫≠t s·∫£n ph·∫©m</div>
<div class="card-body">

<input type="hidden" th:field="*{id}">

<div class="row g-3">

<div class="col-md-4">
<label>T√™n</label>
<input th:field="*{name}" class="form-control">
</div>

<div class="col-md-2">
<label>Gi√°</label>
<input type="number" th:field="*{price}" class="form-control">
</div>

<div class="col-md-6">
<label>Th√™m ·∫£nh m·ªõi</label>
<input type="file" name="imageFiles" multiple class="form-control">
</div>

<div class="col-md-3">
<label>·∫¢nh ƒë·∫°i di·ªán (index)</label>
<input type="number" name="thumbnailIndex" value="0" class="form-control">
</div>

<div class="col-md-3">
<label>Danh m·ª•c</label>
<select th:field="*{category.id}" class="form-select">
<option value="">-- Ch·ªçn --</option>
<option th:each="c:${categories}" th:value="${c.id}" th:text="${c.name}"></option>
</select>
</div>

<div class="col-md-2">
<label>Tr·∫°ng th√°i</label>
<select th:field="*{available}" class="form-select">
<option th:value="true">C√≤n</option>
<option th:value="false">H·∫øt</option>
</select>
</div>

</div>

<button class="btn btn-neon mt-3">C·∫≠p nh·∫≠t</button>
<a th:href="@{/product-mana}" class="btn btn-secondary mt-3">H·ªßy</a>

</div>
</div>
</form>

</div>
</body>
</html>
